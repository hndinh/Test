// <copyright file="View1.controller.js" company="Ancile Solutions Inc.">
//   Copyright Â© 2016 ANCILE Solutions, Inc.
// </copyright>
sap.ui.define(["sap/ui/core/mvc/Controller"], function (Controller) {
	"use strict";
	return Controller.extend("ancilecsh.controller.View1", {
		/**
	*@memberOf ancilecsh.controller.View1
	*/
		onInit: function() {
			var sapUi5Core = sap.ui.getCore();
			// Set tooltip for save button
			var saveButton = sapUi5Core.byId(this.createId("__save"));
			if (saveButton) {
				saveButton.setTooltip("Save");
			}
			var that = this;
			var t = setInterval(function() {
				// Load configuration
				var ANCILECSH = window.ANCILECSH;
				if (ANCILECSH && ANCILECSH.isInitialized()) {
					// HelpServer
					sapUi5Core.byId(that.createId("__txtJsonHelpServer")).setValue(JSON.stringify(ANCILECSH.Configuration.HelpServer, null, 4));
					// HelpButton
					sapUi5Core.byId(that.createId("__txtJsonHelpButton")).setValue(JSON.stringify(ANCILECSH.Configuration.HelpButton, null, 4));
					// HelpPanel
					sapUi5Core.byId(that.createId("__txtJsonHelpPanel")).setValue(JSON.stringify(ANCILECSH.Configuration.HelpPanel, null, 4));
					// ShiftApp
					sapUi5Core.byId(that.createId("__txtJsonShiftApp")).setValue(JSON.stringify(ANCILECSH.Configuration.ShiftApp, null, 4));
					// Context
					sapUi5Core.byId(that.createId("__txtJsonContext")).setValue(JSON.stringify(ANCILECSH.Configuration.Context, null, 4));
					// Monitoring
					sapUi5Core.byId(that.createId("__txtJsonMonitoring")).setValue(JSON.stringify(ANCILECSH.Configuration.Monitoring, null, 4));
					//
					clearInterval(t);
				}
			}, 100);
		},
		
		onsave: function () {
		//This code was generated by the layout editor.
			var sapUi5Core = sap.ui.getCore();
			// Set new configuration
			var ANCILECSH = window.ANCILECSH;
			if (ANCILECSH) {
				// HelpServer
				ANCILECSH.Configuration.HelpServer = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonHelpServer")).getValue());
				// HelpButton
				ANCILECSH.Configuration.HelpButton = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonHelpButton")).getValue());
				// HelpPanel
				ANCILECSH.Configuration.HelpPanel = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonHelpPanel")).getValue());
				// SapUi5App
				ANCILECSH.Configuration.ShiftApp = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonShiftApp")).getValue());
				// Context
				ANCILECSH.Configuration.Context = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonContext")).getValue());
				// Monitoring
				ANCILECSH.Configuration.Monitoring = JSON.parse(sapUi5Core.byId(this.createId("__txtJsonMonitoring")).getValue());
				// Clear user data
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_BUTTON_LAST_DIRECTION, "");
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_BUTTON_LAST_TOP, "");
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_PANEL_LAST_MODE, "");
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_PANEL_LAST_LEFT, "");			
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_PANEL_LAST_TOP, "");
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_PANEL_LAST_WIDTH, "");
				ANCILECSH.Utilities.setUserData(ANCILECSH.Constants.USERDATA_ANCILE_HELP_PANEL_LAST_HEIGHT, "");
			}
			var msgBox = alert;
			msgBox("Saved!");
			// Refresh UI
			ANCILECSH.HelpButton.delete();
			ANCILECSH.HelpPanel.delete();
			ANCILECSH.HelpButton.create();
			ANCILECSH.HelpPanel.create();
		}
	});
});